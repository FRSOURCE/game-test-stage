import{a1 as K,z as m,a2 as N,G as k,a3 as C,a4 as U,a5 as W,w as _,Y as $,Z as X}from"./page-B1C7C4gn.js";import{s as Y}from"./setupGroundSnow-BCfCjGnp.js";import{s as q,a as b,b as ee}from"./setupShadows-Rcri1W_8.js";import"./default.vue_vue_type_script_setup_true_lang-BQczBtLj.js";import"./app-1kYDna_O.js";function te(e,n,t=2){const r=n&&n.length,i=r?n[0]*t:e.length;let x=R(e,0,i,t,!0);const o=[];if(!x||x.next===x.prev)return o;let s,l,c;if(r&&(x=xe(e,n,x,t)),e.length>80*t){s=1/0,l=1/0;let h=-1/0,y=-1/0;for(let w=t;w<i;w+=t){const v=e[w],a=e[w+1];v<s&&(s=v),a<l&&(l=a),v>h&&(h=v),a>y&&(y=a)}c=Math.max(h-s,y-l),c=c!==0?32767/c:0}return S(x,o,t,s,l,c,0),o}function R(e,n,t,r,i){let x;if(i===we(e,n,t,r)>0)for(let o=n;o<t;o+=r)x=G(o/r|0,e[o],e[o+1],x);else for(let o=t-r;o>=n;o-=r)x=G(o/r|0,e[o],e[o+1],x);return x&&d(x,x.next)&&(J(x),x=x.next),x}function P(e,n){if(!e)return e;n||(n=e);let t=e,r;do if(r=!1,!t.steiner&&(d(t,t.next)||p(t.prev,t,t.next)===0)){if(J(t),t=n=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==n);return n}function S(e,n,t,r,i,x,o){if(!e)return;!o&&x&&fe(e,r,i,x);let s=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(x?re(e,r,i,x):ne(e)){n.push(l.i,e.i,c.i),J(e),e=c.next,s=c.next;continue}if(e=c,e===s){o?o===1?(e=ie(P(e),n),S(e,n,t,r,i,x,2)):o===2&&oe(e,n,t,r,i,x):S(P(e),n,t,r,i,x,1);break}}}function ne(e){const n=e.prev,t=e,r=e.next;if(p(n,t,r)>=0)return!1;const i=n.x,x=t.x,o=r.x,s=n.y,l=t.y,c=r.y,h=Math.min(i,x,o),y=Math.min(s,l,c),w=Math.max(i,x,o),v=Math.max(s,l,c);let a=r.next;for(;a!==n;){if(a.x>=h&&a.x<=w&&a.y>=y&&a.y<=v&&I(i,s,x,l,o,c,a.x,a.y)&&p(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function re(e,n,t,r){const i=e.prev,x=e,o=e.next;if(p(i,x,o)>=0)return!1;const s=i.x,l=x.x,c=o.x,h=i.y,y=x.y,w=o.y,v=Math.min(s,l,c),a=Math.min(h,y,w),F=Math.max(s,l,c),Z=Math.max(h,y,w),M=T(v,a,n,t,r),g=T(F,Z,n,t,r);let u=e.prevZ,f=e.nextZ;for(;u&&u.z>=M&&f&&f.z<=g;){if(u.x>=v&&u.x<=F&&u.y>=a&&u.y<=Z&&u!==i&&u!==o&&I(s,h,l,y,c,w,u.x,u.y)&&p(u.prev,u,u.next)>=0||(u=u.prevZ,f.x>=v&&f.x<=F&&f.y>=a&&f.y<=Z&&f!==i&&f!==o&&I(s,h,l,y,c,w,f.x,f.y)&&p(f.prev,f,f.next)>=0))return!1;f=f.nextZ}for(;u&&u.z>=M;){if(u.x>=v&&u.x<=F&&u.y>=a&&u.y<=Z&&u!==i&&u!==o&&I(s,h,l,y,c,w,u.x,u.y)&&p(u.prev,u,u.next)>=0)return!1;u=u.prevZ}for(;f&&f.z<=g;){if(f.x>=v&&f.x<=F&&f.y>=a&&f.y<=Z&&f!==i&&f!==o&&I(s,h,l,y,c,w,f.x,f.y)&&p(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function ie(e,n){let t=e;do{const r=t.prev,i=t.next.next;!d(r,i)&&H(r,t,t.next,i)&&B(r,i)&&B(i,r)&&(n.push(r.i,t.i,i.i),J(t),J(t.next),t=e=i),t=t.next}while(t!==e);return P(t)}function oe(e,n,t,r,i,x){let o=e;do{let s=o.next.next;for(;s!==o.prev;){if(o.i!==s.i&&pe(o,s)){let l=O(o,s);o=P(o,o.next),l=P(l,l.next),S(o,n,t,r,i,x,0),S(l,n,t,r,i,x,0);return}s=s.next}o=o.next}while(o!==e)}function xe(e,n,t,r){const i=[];for(let x=0,o=n.length;x<o;x++){const s=n[x]*r,l=x<o-1?n[x+1]*r:e.length,c=R(e,s,l,r,!1);c===c.next&&(c.steiner=!0),i.push(ye(c))}i.sort(se);for(let x=0;x<i.length;x++)t=le(i[x],t);return t}function se(e,n){let t=e.x-n.x;if(t===0&&(t=e.y-n.y,t===0)){const r=(e.next.y-e.y)/(e.next.x-e.x),i=(n.next.y-n.y)/(n.next.x-n.x);t=r-i}return t}function le(e,n){const t=ue(e,n);if(!t)return n;const r=O(t,e);return P(r,r.next),P(t,t.next)}function ue(e,n){let t=n;const r=e.x,i=e.y;let x=-1/0,o;if(d(e,t))return t;do{if(d(e,t.next))return t.next;if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){const y=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(y<=r&&y>x&&(x=y,o=t.x<t.next.x?t:t.next,y===r))return o}t=t.next}while(t!==n);if(!o)return null;const s=o,l=o.x,c=o.y;let h=1/0;t=o;do{if(r>=t.x&&t.x>=l&&r!==t.x&&j(i<c?r:x,i,l,c,i<c?x:r,i,t.x,t.y)){const y=Math.abs(i-t.y)/(r-t.x);B(t,e)&&(y<h||y===h&&(t.x>o.x||t.x===o.x&&ce(o,t)))&&(o=t,h=y)}t=t.next}while(t!==s);return o}function ce(e,n){return p(e.prev,e,n.prev)<0&&p(n.next,e,e.next)<0}function fe(e,n,t,r){let i=e;do i.z===0&&(i.z=T(i.x,i.y,n,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,ae(i)}function ae(e){let n,t=1;do{let r=e,i;e=null;let x=null;for(n=0;r;){n++;let o=r,s=0;for(let c=0;c<t&&(s++,o=o.nextZ,!!o);c++);let l=t;for(;s>0||l>0&&o;)s!==0&&(l===0||!o||r.z<=o.z)?(i=r,r=r.nextZ,s--):(i=o,o=o.nextZ,l--),x?x.nextZ=i:e=i,i.prevZ=x,x=i;r=o}x.nextZ=null,t*=2}while(n>1);return e}function T(e,n,t,r,i){return e=(e-t)*i|0,n=(n-r)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e|n<<1}function ye(e){let n=e,t=e;do(n.x<t.x||n.x===t.x&&n.y<t.y)&&(t=n),n=n.next;while(n!==e);return t}function j(e,n,t,r,i,x,o,s){return(i-o)*(n-s)>=(e-o)*(x-s)&&(e-o)*(r-s)>=(t-o)*(n-s)&&(t-o)*(x-s)>=(i-o)*(r-s)}function I(e,n,t,r,i,x,o,s){return!(e===o&&n===s)&&j(e,n,t,r,i,x,o,s)}function pe(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!he(e,n)&&(B(e,n)&&B(n,e)&&ve(e,n)&&(p(e.prev,e,n.prev)||p(e,n.prev,n))||d(e,n)&&p(e.prev,e,e.next)>0&&p(n.prev,n,n.next)>0)}function p(e,n,t){return(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)}function d(e,n){return e.x===n.x&&e.y===n.y}function H(e,n,t,r){const i=L(p(e,n,t)),x=L(p(e,n,r)),o=L(p(t,r,e)),s=L(p(t,r,n));return!!(i!==x&&o!==s||i===0&&E(e,t,n)||x===0&&E(e,r,n)||o===0&&E(t,e,r)||s===0&&E(t,n,r))}function E(e,n,t){return n.x<=Math.max(e.x,t.x)&&n.x>=Math.min(e.x,t.x)&&n.y<=Math.max(e.y,t.y)&&n.y>=Math.min(e.y,t.y)}function L(e){return e>0?1:e<0?-1:0}function he(e,n){let t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==n.i&&t.next.i!==n.i&&H(t,t.next,e,n))return!0;t=t.next}while(t!==e);return!1}function B(e,n){return p(e.prev,e,e.next)<0?p(e,n,e.next)>=0&&p(e,e.prev,n)>=0:p(e,n,e.prev)<0||p(e,e.next,n)<0}function ve(e,n){let t=e,r=!1;const i=(e.x+n.x)/2,x=(e.y+n.y)/2;do t.y>x!=t.next.y>x&&t.next.y!==t.y&&i<(t.next.x-t.x)*(x-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==e);return r}function O(e,n){const t=V(e.i,e.x,e.y),r=V(n.i,n.x,n.y),i=e.next,x=n.prev;return e.next=n,n.prev=e,t.next=i,i.prev=t,r.next=t,t.prev=r,x.next=r,r.prev=x,r}function G(e,n,t,r){const i=V(e,n,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function J(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function V(e,n,t){return{i:e,x:n,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function we(e,n,t,r){let i=0;for(let x=n,o=t-r;x<t;x+=r)i+=(e[o]-e[x])*(e[x+1]+e[o+1]),o=x;return i}const Fe=(e,n,t,r)=>{const i=new k(e.x,e.y),x=new k(n.x,n.y),o=N.BetweenTwoPoints(x,i).radians(),s=k.Distance(i,x),l=C("skiJump",{width:t.width,height:s},r);return l.rotation.addInPlaceFromFloats(Math.PI/2-o,Math.PI/2,0),l.position=m.Lerp(e,n,.5),l},me=({first2Points:e,skiJumpBacksideHeight:n})=>{const t=Math.tan(N.BetweenTwoPoints(new k(e[1].x,e[1].y),new k(e[0].x,e[0].y)).radians()),r=n/t-e[0].y/t+e[0].x;return new m(r,n,0)},Ze=({scene:e,frontHeight:n,backHeight:t,width:r,length:i,position:x})=>{const o=new m(i*.7,n+9,0),s=new m(i*.5,n-1.5,0),l=new m(0,n,0),h=K.CreateQuadraticBezier(o,s,l,64).getPoints(),y=me({first2Points:h.slice(0,2),skiJumpBacksideHeight:t}),v=[new m(i,t,0),y,...h],a=[];v.forEach((z,A,D)=>{if(D[A+1]){const Q=Fe(z,D[A+1],{width:r},e);a.push(Q)}});const F=U("skiJumpSide",{shape:[new m(0,0,0),new m(i,0,0),...v.map(z=>new m(z.x,0,z.y))]},e,te);F.rotation.addInPlaceFromFloats(-Math.PI/2,0,0),F.position.addInPlaceFromFloats(0,0,-r/2);const Z=F.clone("skiJumpSide2");Z.scaling.addInPlaceFromFloats(0,-2,0),Z.position.addInPlaceFromFloats(0,0,r);const M=C("skiJumpFront",{width:r,height:n},e);M.position.addInPlaceFromFloats(0,n/2,0),M.rotation.addInPlaceFromFloats(0,Math.PI/2,0);const g=C("skiJumpBack",{width:r,height:t},e);g.position.addInPlaceFromFloats(i,t/2,0),g.rotation.addInPlaceFromFloats(0,-Math.PI/2,0),a.push(F,Z,M,g);const u=W.MergeMeshes(a),f=new _("skiJumpMaterial",e);return u.material=f,u.receiveShadows=!0,f.roughness=.4,u.position.addInPlace(x),new $(u,X.MESH,{mass:0},e)},Se=({scene:e})=>{const n=Y({scene:e}),t=q({scene:e});b({scene:e}),Ze({scene:e,position:new m(26.5,0,-2),frontHeight:15.2,backHeight:29,width:5,length:18});const r=ee({scene:e});return{ground:n,shadows:r,env:t}};export{Se as setup};
