import{a1 as K,A as m,a2 as U,a3 as C,a4 as W,w as _,Y as $,Z as X,a5 as R,I as k}from"./page-B55QENM7.js";import{s as Y}from"./setupGroundSnow-BZaRi4C9.js";import{s as q,a as b,b as ee}from"./setupShadows-BEgWD5L-.js";import"./default.vue_vue_type_script_setup_true_lang-Snf55EXC.js";import"./app-k0R6VPNA.js";function te(e,n,t=2){const i=n&&n.length,r=i?n[0]*t:e.length;let x=j(e,0,r,t,!0);const o=[];if(!x||x.next===x.prev)return o;let s,l,c;if(i&&(x=xe(e,n,x,t)),e.length>80*t){s=1/0,l=1/0;let h=-1/0,y=-1/0;for(let w=t;w<r;w+=t){const v=e[w],a=e[w+1];v<s&&(s=v),a<l&&(l=a),v>h&&(h=v),a>y&&(y=a)}c=Math.max(h-s,y-l),c=c!==0?32767/c:0}return S(x,o,t,s,l,c,0),o}function j(e,n,t,i,r){let x;if(r===we(e,n,t,i)>0)for(let o=n;o<t;o+=i)x=N(o/i|0,e[o],e[o+1],x);else for(let o=t-i;o>=n;o-=i)x=N(o/i|0,e[o],e[o+1],x);return x&&d(x,x.next)&&(J(x),x=x.next),x}function P(e,n){if(!e)return e;n||(n=e);let t=e,i;do if(i=!1,!t.steiner&&(d(t,t.next)||p(t.prev,t,t.next)===0)){if(J(t),t=n=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==n);return n}function S(e,n,t,i,r,x,o){if(!e)return;!o&&x&&fe(e,i,r,x);let s=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(x?re(e,i,r,x):ne(e)){n.push(l.i,e.i,c.i),J(e),e=c.next,s=c.next;continue}if(e=c,e===s){o?o===1?(e=ie(P(e),n),S(e,n,t,i,r,x,2)):o===2&&oe(e,n,t,i,r,x):S(P(e),n,t,i,r,x,1);break}}}function ne(e){const n=e.prev,t=e,i=e.next;if(p(n,t,i)>=0)return!1;const r=n.x,x=t.x,o=i.x,s=n.y,l=t.y,c=i.y,h=Math.min(r,x,o),y=Math.min(s,l,c),w=Math.max(r,x,o),v=Math.max(s,l,c);let a=i.next;for(;a!==n;){if(a.x>=h&&a.x<=w&&a.y>=y&&a.y<=v&&I(r,s,x,l,o,c,a.x,a.y)&&p(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function re(e,n,t,i){const r=e.prev,x=e,o=e.next;if(p(r,x,o)>=0)return!1;const s=r.x,l=x.x,c=o.x,h=r.y,y=x.y,w=o.y,v=Math.min(s,l,c),a=Math.min(h,y,w),F=Math.max(s,l,c),Z=Math.max(h,y,w),M=T(v,a,n,t,i),g=T(F,Z,n,t,i);let u=e.prevZ,f=e.nextZ;for(;u&&u.z>=M&&f&&f.z<=g;){if(u.x>=v&&u.x<=F&&u.y>=a&&u.y<=Z&&u!==r&&u!==o&&I(s,h,l,y,c,w,u.x,u.y)&&p(u.prev,u,u.next)>=0||(u=u.prevZ,f.x>=v&&f.x<=F&&f.y>=a&&f.y<=Z&&f!==r&&f!==o&&I(s,h,l,y,c,w,f.x,f.y)&&p(f.prev,f,f.next)>=0))return!1;f=f.nextZ}for(;u&&u.z>=M;){if(u.x>=v&&u.x<=F&&u.y>=a&&u.y<=Z&&u!==r&&u!==o&&I(s,h,l,y,c,w,u.x,u.y)&&p(u.prev,u,u.next)>=0)return!1;u=u.prevZ}for(;f&&f.z<=g;){if(f.x>=v&&f.x<=F&&f.y>=a&&f.y<=Z&&f!==r&&f!==o&&I(s,h,l,y,c,w,f.x,f.y)&&p(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function ie(e,n){let t=e;do{const i=t.prev,r=t.next.next;!d(i,r)&&H(i,t,t.next,r)&&B(i,r)&&B(r,i)&&(n.push(i.i,t.i,r.i),J(t),J(t.next),t=e=r),t=t.next}while(t!==e);return P(t)}function oe(e,n,t,i,r,x){let o=e;do{let s=o.next.next;for(;s!==o.prev;){if(o.i!==s.i&&pe(o,s)){let l=O(o,s);o=P(o,o.next),l=P(l,l.next),S(o,n,t,i,r,x,0),S(l,n,t,i,r,x,0);return}s=s.next}o=o.next}while(o!==e)}function xe(e,n,t,i){const r=[];for(let x=0,o=n.length;x<o;x++){const s=n[x]*i,l=x<o-1?n[x+1]*i:e.length,c=j(e,s,l,i,!1);c===c.next&&(c.steiner=!0),r.push(ye(c))}r.sort(se);for(let x=0;x<r.length;x++)t=le(r[x],t);return t}function se(e,n){let t=e.x-n.x;if(t===0&&(t=e.y-n.y,t===0)){const i=(e.next.y-e.y)/(e.next.x-e.x),r=(n.next.y-n.y)/(n.next.x-n.x);t=i-r}return t}function le(e,n){const t=ue(e,n);if(!t)return n;const i=O(t,e);return P(i,i.next),P(t,t.next)}function ue(e,n){let t=n;const i=e.x,r=e.y;let x=-1/0,o;if(d(e,t))return t;do{if(d(e,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const y=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(y<=i&&y>x&&(x=y,o=t.x<t.next.x?t:t.next,y===i))return o}t=t.next}while(t!==n);if(!o)return null;const s=o,l=o.x,c=o.y;let h=1/0;t=o;do{if(i>=t.x&&t.x>=l&&i!==t.x&&G(r<c?i:x,r,l,c,r<c?x:i,r,t.x,t.y)){const y=Math.abs(r-t.y)/(i-t.x);B(t,e)&&(y<h||y===h&&(t.x>o.x||t.x===o.x&&ce(o,t)))&&(o=t,h=y)}t=t.next}while(t!==s);return o}function ce(e,n){return p(e.prev,e,n.prev)<0&&p(n.next,e,e.next)<0}function fe(e,n,t,i){let r=e;do r.z===0&&(r.z=T(r.x,r.y,n,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,ae(r)}function ae(e){let n,t=1;do{let i=e,r;e=null;let x=null;for(n=0;i;){n++;let o=i,s=0;for(let c=0;c<t&&(s++,o=o.nextZ,!!o);c++);let l=t;for(;s>0||l>0&&o;)s!==0&&(l===0||!o||i.z<=o.z)?(r=i,i=i.nextZ,s--):(r=o,o=o.nextZ,l--),x?x.nextZ=r:e=r,r.prevZ=x,x=r;i=o}x.nextZ=null,t*=2}while(n>1);return e}function T(e,n,t,i,r){return e=(e-t)*r|0,n=(n-i)*r|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e|n<<1}function ye(e){let n=e,t=e;do(n.x<t.x||n.x===t.x&&n.y<t.y)&&(t=n),n=n.next;while(n!==e);return t}function G(e,n,t,i,r,x,o,s){return(r-o)*(n-s)>=(e-o)*(x-s)&&(e-o)*(i-s)>=(t-o)*(n-s)&&(t-o)*(x-s)>=(r-o)*(i-s)}function I(e,n,t,i,r,x,o,s){return!(e===o&&n===s)&&G(e,n,t,i,r,x,o,s)}function pe(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!he(e,n)&&(B(e,n)&&B(n,e)&&ve(e,n)&&(p(e.prev,e,n.prev)||p(e,n.prev,n))||d(e,n)&&p(e.prev,e,e.next)>0&&p(n.prev,n,n.next)>0)}function p(e,n,t){return(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)}function d(e,n){return e.x===n.x&&e.y===n.y}function H(e,n,t,i){const r=z(p(e,n,t)),x=z(p(e,n,i)),o=z(p(t,i,e)),s=z(p(t,i,n));return!!(r!==x&&o!==s||r===0&&L(e,t,n)||x===0&&L(e,i,n)||o===0&&L(t,e,i)||s===0&&L(t,n,i))}function L(e,n,t){return n.x<=Math.max(e.x,t.x)&&n.x>=Math.min(e.x,t.x)&&n.y<=Math.max(e.y,t.y)&&n.y>=Math.min(e.y,t.y)}function z(e){return e>0?1:e<0?-1:0}function he(e,n){let t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==n.i&&t.next.i!==n.i&&H(t,t.next,e,n))return!0;t=t.next}while(t!==e);return!1}function B(e,n){return p(e.prev,e,e.next)<0?p(e,n,e.next)>=0&&p(e,e.prev,n)>=0:p(e,n,e.prev)<0||p(e,e.next,n)<0}function ve(e,n){let t=e,i=!1;const r=(e.x+n.x)/2,x=(e.y+n.y)/2;do t.y>x!=t.next.y>x&&t.next.y!==t.y&&r<(t.next.x-t.x)*(x-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==e);return i}function O(e,n){const t=A(e.i,e.x,e.y),i=A(n.i,n.x,n.y),r=e.next,x=n.prev;return e.next=n,n.prev=e,t.next=r,r.prev=t,i.next=t,t.prev=i,x.next=i,i.prev=x,i}function N(e,n,t,i){const r=A(e,n,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function J(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function A(e,n,t){return{i:e,x:n,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function we(e,n,t,i){let r=0;for(let x=n,o=t-i;x<t;x+=i)r+=(e[o]-e[x])*(e[x+1]+e[o+1]),o=x;return r}const Fe=(e,n,t,i)=>{const r=new k(e.x,e.y),x=new k(n.x,n.y),o=R.BetweenTwoPoints(x,r).radians(),s=k.Distance(r,x),l=C("skiJump",{width:t.width,height:s},i);return l.rotation.addInPlaceFromFloats(Math.PI/2-o,Math.PI/2,0),l.position=m.Lerp(e,n,.5),l},me=({first2Points:e,skiJumpBacksideHeight:n})=>{const t=Math.tan(R.BetweenTwoPoints(new k(e[1].x,e[1].y),new k(e[0].x,e[0].y)).radians()),i=n/t-e[0].y/t+e[0].x;return new m(i,n,0)},Ze=({scene:e,frontHeight:n,backHeight:t,width:i,length:r,position:x})=>{const o=new m(r*.7,n+9,0),s=new m(r*.5,n-1.5,0),l=new m(0,n,0),h=K.CreateQuadraticBezier(o,s,l,64).getPoints(),y=me({first2Points:h.slice(0,2),skiJumpBacksideHeight:t}),v=[new m(r,t,0),y,...h],a=[];v.forEach((E,V,D)=>{if(D[V+1]){const Q=Fe(E,D[V+1],{width:i},e);a.push(Q)}});const F=U("skiJumpSide",{shape:[new m(0,0,0),new m(r,0,0),...v.map(E=>new m(E.x,0,E.y))]},e,te);F.rotation.addInPlaceFromFloats(-Math.PI/2,0,0),F.position.addInPlaceFromFloats(0,0,-5/2);const Z=F.clone("skiJumpSide2");Z.scaling.addInPlaceFromFloats(0,-2,0),Z.position.addInPlaceFromFloats(0,0,i);const M=C("skiJumpFront",{width:i,height:n},e);M.position.addInPlaceFromFloats(0,n/2,0),M.rotation.addInPlaceFromFloats(0,Math.PI/2,0);const g=C("skiJumpBack",{width:i,height:t},e);g.position.addInPlaceFromFloats(r,t/2,0),g.rotation.addInPlaceFromFloats(0,-Math.PI/2,0),a.push(F,Z,M,g);const u=W.MergeMeshes(a),f=new _("skiJumpMaterial",e);return u.material=f,u.receiveShadows=!0,f.roughness=.4,u.position.addInPlace(x),new $(u,X.MESH,{mass:0},e)},Se=({scene:e})=>{const n=Y({scene:e}),t=q({scene:e});b({scene:e}),Ze({scene:e,position:new m(26.5,0,-2),frontHeight:15.2,backHeight:29,width:5,length:18});const i=ee({scene:e});return{ground:n,shadows:i,env:t}};export{Se as setup};
